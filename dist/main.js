#!/usr/bin/env node
!function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=10)}([function(e,r){e.exports='exports.{{!--actionName--!}} = (req, res, next) => {\r\n    res.send("You have just reached action: {{!--actionName--!}}");\r\n}'},function(e,r){e.exports="exports.getIndex = (req, res, next) => {\r\n    res.render('index', { title: 'Express' });\r\n}"},function(e,r){e.exports="var viewConfig = require('./config/view');\r\nvar errorConfig = require('./config/error');\r\nvar utilitiesConfig = require('./config/utilities');\r\nvar routesConfig = require('./config/routes');\r\nvar Sequelize = require('sequelize');\r\n\r\nvar express = require('express');\r\n\r\nvar app = express();\r\n\r\nviewConfig(app);\r\nutilitiesConfig(app);\r\nroutesConfig(app);\r\nerrorConfig(app);\r\n\r\nmodule.exports = app;\r\n"},function(e,r){e.exports="var createError = require('http-errors');\r\n\r\nmodule.exports = (app) => {\r\n    app.use(function (req, res, next) {\r\n        next(createError(404));\r\n    });\r\n    \r\n    // error handler\r\n    app.use(function (err, req, res, next) {\r\n        // set locals, only providing error in development\r\n        res.locals.message = err.message;\r\n        res.locals.error = req.app.get('env') === 'development' ? err : {};\r\n    \r\n        // render the error page\r\n        res.status(err.status || 500);\r\n        res.render('error');\r\n    });\r\n};"},function(e,r){e.exports="var indexRouter = require('../routes/index');\r\n\r\nmodule.exports = (app) => {\r\n    app.use('/', indexRouter);\r\n    // !-- Do not remove this line --! //\r\n};"},function(e,r){e.exports="var logger = require('morgan');\r\nvar express = require('express');\r\nvar path = require('path');\r\nvar cookieParser = require('cookie-parser');\r\n\r\nmodule.exports = (app) => {\r\n    app.use(logger('dev'));\r\n    app.use(express.json());\r\n    app.use(express.urlencoded({ extended: false }));\r\n    app.use(cookieParser());\r\n    app.use(express.static(path.join(__dirname,'..','public')));\r\n};"},function(e,r){e.exports="var path = require('path');\r\n\r\nmodule.exports = (app) => {\r\n    app.set('views', path.join(__dirname,'..', 'views'));\r\n    app.set('view engine', '{{!--view_engine--}}');\r\n};"},function(e,r){e.exports='{\r\n    "development": {\r\n      "username": "root",\r\n      "password": null,\r\n      "database": "database_development",\r\n      "dialect": "sqlite",\r\n      "storage": "./main.sqlite"\r\n    },\r\n    "test": {\r\n      "username": "root",\r\n      "password": null,\r\n      "database": "database_test",\r\n      "dialect": "sqlite",\r\n      "storage": "./main.sqlite"\r\n    },\r\n    "production": {\r\n      "username": "root",\r\n      "password": null,\r\n      "database": "database_production",\r\n      "dialect": "sqlite",\r\n      "storage": "./main.sqlite"\r\n    }\r\n  }\r\n  '},function(e,r){e.exports="var express = require('express');\r\nvar router = express.Router();\r\nvar indexController = require('../controllers/index.js');\r\n/* GET home page. */\r\nrouter.get('/', indexController.getIndex);\r\n\r\nmodule.exports = router;\r\n"},function(e,r){e.exports="var express = require('express');\r\nvar router = express.Router();\r\nvar {{!--routeName--!}}Controller = require('../controllers/{{!--routeName--!}}.js');\r\n\r\n// !-- Do not remove this line --! //\r\n\r\nmodule.exports = router;\r\n"},function(e,r,n){"use strict";n.r(r);var t=n(1),o=n.n(t),s=n(2),i=n.n(s),a=n(3),l=n.n(a),u=n(4),c=n.n(u),p=n(5),d=n.n(p),g=n(6),f=n.n(g),x=n(7),m=n.n(x),v=n(8),j=n.n(v),h=n(0),q=n.n(h),w=n(9),y=n.n(w),S=n(11),b=n(12),F=n(13),C=n(14);const _="controllers",E="config",k="routes";b.config.silent=!1,S.command("new <name>").action(e=>{let r;console.log("Installing express-generator ..."),b.exec("npm install express-generator -g"),console.log("Creating express project ..."),C.prompt([{type:"list",name:"viewEngine",message:"Which view engine you want to use ?",default:"no-view",choices:["ejs","hbs","hjs","jade","pug","twig","vash"]}]).then(n=>{r=n.viewEngine,b.exec("express --force --view="+r+" "+e),b.cd(e),b.exec("npm install"),b.exec("npm install sqlite3 --save"),b.exec("npm install sequelize --save"),b.exec("npm install sequelize-cli -g --save"),b.exec("sequelize init"),F.writeFileSync("./app.js",i.a,e=>{b.echo(e)}),b.mkdir(_),b.cd(E),F.writeFileSync("./config.json",m.a),b.touch("error.js"),b.touch("routes.js"),b.touch("utilities.js"),b.touch("view.js"),b.touch("config.json"),F.writeFileSync("./error.js",l.a),F.writeFileSync("./routes.js",c.a),F.writeFileSync("./utilities.js",d.a),F.writeFileSync("./view.js",f.a.replace("{{!--view_engine--}}",r)),b.cd(".."),b.cd(_),b.touch("index.js"),F.writeFileSync("./index.js",o.a),b.cd("../routes"),b.rm("users.js"),F.writeFileSync("./index.js",j.a)})}),S.command("db:migrate").action(()=>{b.exec("sequelize db:migrate")}),S.command("generate [tool] <toolName> [toolActions...]").action((e,r,n)=>{if(function(){let e=b.test("-e","bin")&&b.test("-e","config")&&b.test("-e","controllers")&&b.test("-e","node_modules")&&b.test("-e","routes")&&b.test("-e","views")&&b.test("-e","app.js")&&b.test("-e","package-lock.json")&&b.test("-e","package.json");b.cd(E);let r=e&&b.test("-e","error.js")&&b.test("-e","routes.js")&&b.test("-e","utilities.js")&&b.test("-e","view.js");return b.cd(".."),r}())switch(e){case"controller":if(b.config.silent=!0,function(e){let r=e+".js";if(b.cd(_),b.test("-e",r))return!0;b.cd(".."),b.cd(E);let n=F.readFileSync("routes.js").toString(),t=new RegExp("app.use('/"+e+"')");if(n.match(t))return!0;if(b.cd(".."),b.cd(k),b.test("-e",r))return!0;return b.cd(".."),!1}(r))return void console.error("Error: Controller "+r+" already exists.");!function(e,r,n){b.test("-e",_)||b.mkdir("controllers");b.cd(_);let t=r+".js";if(b.test("-e",t))return!0;console.log("Controller Name: "+r),b.rm(t),b.touch(t),console.log("Successfully generate controller with name: "+t);let o=q.a.replace(/{{!--actionName--!}}/g,"getIndex")+"\n\n",s=F.readFileSync(t);F.writeFileSync(t,s.toString()+o),n.forEach(e=>{let r=q.a.replace(/{{!--actionName--!}}/g,e)+"\n\n",n=F.readFileSync(t);F.writeFileSync(t,n.toString()+r)})}(0,r,n),function(e,r,n){let t=r+".js";b.cd(".."),b.cd("routes"),b.touch(t),F.writeFileSync(t,y.a.replace(/{{!--routeName--!}}/g,r));let o=F.readFileSync(t).toString();o=o.replace(/\/\/ !-- Do not remove this line --! \/\//,e=>{let n="router.all('/',"+r+"Controller.getIndex);\n"+e;return n}),n.forEach(e=>{o=o.replace(/\/\/ !-- Do not remove this line --! \/\//,n=>{let t="router.all('/"+e+"',"+r+"Controller."+e+");\n"+n;return t})}),F.writeFileSync(t,o)}(0,r,n),function(e,r,n){b.cd("../config");let t=F.readFileSync("routes.js").toString(),o=r+"Router",s=(t=t.replace(/\/\/ !-- Do not remove this line --! \/\//,e=>{let n="app.use('/"+r+"',"+o+");\n    "+e;return n})).match(/require\(.*\);/g),i=s[s.length-1];t=t.replace(i,i+"\nvar "+o+" = require('../routes/"+r+"');"),F.writeFileSync("routes.js",t)}(0,r),b.config.silent=!1;break;case"model":let t="sequelize model:generate --name "+r+" --attributes ";n.forEach((e,r,n)=>{n.length-1!=r?t+=e+",":t+=e}),b.exec(t)}else console.error("Error: You are not in a valid express-generate project")}),S.parse(process.argv)},function(e,r){e.exports=require("commander")},function(e,r){e.exports=require("shelljs")},function(e,r){e.exports=require("fs")},function(e,r){e.exports=require("inquirer")}]);